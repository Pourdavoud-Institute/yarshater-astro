---
import type { RelatedLinks } from '@content/schemaFragments/pageModules';
import SanityImage from '@components/SanityImage.astro';
import { sanityLink } from '@lib/utils/sanityLink';
import v from 'voca';

interface Props {
    module: RelatedLinks;
    padding?: boolean;
}

const { module, padding = true } = Astro.props;
---

<section
    class:list={[
        padding && 'section-padding bg-gray',
        { 'section-margin': module.options.sectionMargin },
    ]}
    data-module={module._type}
>
    <div class="content-wrapper">
        <h2 id={v.slugify(module.heading)}>{module.heading}</h2>
        <div class="links | fluid-grid | space-l-top">
            {
                module.links.map((link) => {
                    const linkParts = sanityLink(link);
                    return (
                        <article>
                            <a
                                class="image-wrapper"
                                href={linkParts.url}
                                target={linkParts.target}
                                title={linkParts.label}
                            >
                                <SanityImage
                                    alt={link.image.alt}
                                    aspectRatio={[3, 2]}
                                    source={link.image}
                                    width={600}
                                />
                            </a>
                            <a
                                class="related-link title-link | with-icon"
                                href={linkParts.url}
                                target={linkParts.target}
                            >
                                <span>{linkParts.label}</span>
                                {linkParts.target === '_blank' && (
                                    <svg
                                        aria-hidden="true"
                                        height="20"
                                        viewBox="0 0 24 24"
                                        width="20"
                                        xmlns="http://www.w3.org/2000/svg"
                                    >
                                        <path d="M19 19H5V5H12V3H5C3.89 3 3 3.9 3 5V19C3 20.1 3.89 21 5 21H19C20.1 21 21 20.1 21 19V12H19V19ZM14 3V5H17.59L7.76 14.83L9.17 16.24L19 6.41V10H21V3H14Z" />
                                    </svg>
                                )}
                            </a>
                        </article>
                    );
                })
            }
        </div>
    </div>
    <img
        alt=""
        class="pourdavoud-seal"
        src="/images/logos/pourdavoud-seal-web.svg"
    />
</section>

<style>
    section {
        position: relative;
        overflow: hidden;
    }

    .content-wrapper {
        z-index: 2;
    }

    .fluid-grid {
        --grid-item-min-size: 20rem;
    }

    .image-wrapper {
        display: block;
        background-color: var(--ucla-darker-blue);

        &:hover img {
            filter: grayscale(1);
            /* mix-blend-mode: multiply; */
            opacity: 0.3;
        }

        & img {
            width: 100%;
            transition: all 0.3s;
        }
    }

    .related-link {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-family: var(--font-heading);
        font-weight: 700;
        line-height: var(--leading-tight);
        font-size: var(--step-2);
        margin-block-start: var(--space-s);
    }

    .pourdavoud-seal {
        position: absolute;
        top: 3rem;
        left: 2rem;
        width: max(20%, 15rem);
        opacity: 0.1;
    }
</style>
